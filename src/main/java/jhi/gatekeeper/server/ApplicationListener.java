package jhi.gatekeeper.server;

import java.util.logging.*;

import javax.servlet.*;

import jhi.gatekeeper.resource.ServerProperty;
import jhi.gatekeeper.server.resource.TokenResource;
import jhi.gatekeeper.server.util.Email;
import jhi.gatekeeper.server.util.watcher.PropertyWatcher;

public class ApplicationListener implements ServletContextListener
{
	@Override
	public void contextInitialized(ServletContextEvent sce)
	{
		logMessage();

		PropertyWatcher.initialize();
		Email.init();

		Integer salt;
		try
		{
			salt = PropertyWatcher.getInteger(ServerProperty.SALT);
		}
		catch (Exception e)
		{
			salt = 10;
		}

		TokenResource.SALT = salt;
	}

	@Override
	public void contextDestroyed(ServletContextEvent servletContextEvent)
	{
	}

	private void logMessage()
	{
		Logger.getLogger("").log(Level.INFO, "\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@#################%@@@@@@@@@@@@@@@@%////////@@@\r\n" +
			"@@@@@@@@@@@#####################@@@@@@@@@@@@@@(///////#@@@@\r\n" +
			"@@@@@@@@@@#######################@@@@@@@@@@@@////////@@@@@@\r\n" +
			"@@@@@@@@@((((((((@@@@@@@@@@@@@@@@@@@@@@@@@@@////////@@@@@@@\r\n" +
			"@@@@@@@@((((((((@@@@@@@@@@@@@@@@@@@@@@@@@@@////////@@@@@@@@\r\n" +
			"@@@@@@@((((((((@@@@@@@@@@@@@@@@@@@@@@@@@@@////////@@@@@@@@@\r\n" +
			"@@@@@&((((((((@@@@@@@@@@@@@@@@@@@@@@@@@@@////////@@@@@@@@@@\r\n" +
			"@@@@#(((((((/@@@@@@@@@@@@@@@@@@@@@@@@@@%##//////@@@@@@@@@@@\r\n" +
			"@@@((((((((@@@@@@@@@@@@@@@@@@@@@@@@@@@%####///(@@@@@@@@@@@@\r\n" +
			"@@@(((((((@@@@@@@@@@@@@@@@@@@@@@@@@@@(######/(@@@@@@@@@@@@@\r\n" +
			"@@@(((((((@@@@@@@@,,,,,,,,,,,,,,,*@@@@#######@@@@@@@@@@@@@@\r\n" +
			"@@@((((((((@@@@@@@@,,,,,,,,,,,,,***@@@%#######@@@@@@@@@@@@@\r\n" +
			"@@@@/(((((((#@@@@@@@,,,,,,,,,,,*****@@@%#######@@@@@@@@@@@@\r\n" +
			"@@@@@@((((((((@@@@@@@@@@@@@@@********@@@@#######@@@@@@@@@@@\r\n" +
			"@@@@@@@((((((((@@@@@@@@@@@@@********@@@@@@########@@@@@@@@@\r\n" +
			"@@@@@@@@((((((((@@@@@@@@@@@********@@@@@@@@########@@@@@@@@\r\n" +
			"@@@@@@@@@((((((((@@@@@@@@@********@@@@@@@@@@########@@@@@@@\r\n" +
			"@@@@@@@@@@((((((((///////////////@@@@@@@@@@@@########@@@@@@\r\n" +
			"@@@@@@@@@@@((((((((////////////*@@@@@@@@@@@@@@%#######%@@@@\r\n" +
			"@@@@@@@@@@@@@(((((((//////////@@@@@@@@@@@@@@@@@%########@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" +
			"\r\n" +
			"               Thanks for using Gatekeeper!\r\n");
	}
}
